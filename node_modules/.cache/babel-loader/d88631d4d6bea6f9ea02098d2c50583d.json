{"ast":null,"code":"import _regeneratorRuntime from \"C:\\\\Users\\\\raheem.azeezat\\\\Desktop\\\\e-voting\\\\node_modules\\\\@babel\\\\runtime/regenerator\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\raheem.azeezat\\\\Desktop\\\\e-voting\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"C:\\\\Users\\\\raheem.azeezat\\\\Desktop\\\\e-voting\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\raheem.azeezat\\\\Desktop\\\\e-voting\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\raheem.azeezat\\\\Desktop\\\\e-voting\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\raheem.azeezat\\\\Desktop\\\\e-voting\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\raheem.azeezat\\\\Desktop\\\\e-voting\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\Users\\\\raheem.azeezat\\\\Desktop\\\\e-voting\\\\src\\\\Components\\\\Election.js\";\nimport React, { Component } from 'react';\nimport { Card, Icon, Image, Container, Button, Accordion } from 'semantic-ui-react';\nimport firebaseConf from './Firebase';\nimport per from './6.jpg';\n\nvar AccordionExampleStandard =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(AccordionExampleStandard, _Component);\n\n  function AccordionExampleStandard() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, AccordionExampleStandard);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(AccordionExampleStandard)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      activeIndex: '',\n      contestantsPost: [],\n      filteredPost: []\n    };\n\n    _this.handleClick =\n    /*#__PURE__*/\n    function () {\n      var _ref = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(e, titleProps) {\n        var contestantsPost, index, activeIndex, newIndex, filteredPost, hasVoted;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                contestantsPost = _this.state.contestantsPost;\n                index = titleProps.index;\n                activeIndex = _this.state.activeIndex;\n                newIndex = activeIndex === index ? -1 : index;\n\n                _this.setState({\n                  activeIndex: newIndex\n                }); // Filter the current post that is opened\n\n\n                _context.next = 7;\n                return contestantsPost.filter(function (item, index) {\n                  return index === newIndex;\n                });\n\n              case 7:\n                filteredPost = _context.sent;\n                _context.next = 10;\n                return _this.setState({\n                  filteredPost: filteredPost\n                });\n\n              case 10:\n                hasVoted = filteredPost.aspirants.map(function (item) {\n                  item.votes.map(function (item) {\n                    return item.voterId === _this.state.voterId;\n                  });\n                });\n                console.log(_this.state.filteredPost);\n                console.log(hasVoted);\n\n              case 13:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      return function (_x, _x2) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    _this.handleUnvote = function (prefectId, aspirantKey) {\n      return function () {\n        var voterId = _this.state.voterId;\n        var removeRef = firebaseConf.database().ref(\"posts/\".concat(prefectId, \"/aspirants/\").concat(aspirantKey, \"/votes/\").concat(voterId));\n        removeRef.remove();\n      };\n    };\n\n    _this.handleVote = function (prefectId, aspirantKey) {\n      return function () {\n        var voterId = _this.state.voterId;\n        var itemsRef = firebaseConf.database().ref(\"posts/\".concat(prefectId, \"/aspirants/\").concat(aspirantKey, \"/votes\"));\n        itemsRef.child(voterId).set({\n          voterId: voterId\n        }).then(function () {}).catch(function (message) {\n          console.log(\"this is the error :\".concat(message));\n\n          _this.showAlert('danger', message);\n        });\n\n        _this.setState({\n          isLoading: false\n        });\n      };\n    };\n\n    _this.fetchAspirantsdata = function () {\n      firebaseConf.database().ref('posts').orderByChild('post').on('value', function (snapshot) {\n        var contestantsPost = [];\n        snapshot.forEach(function (data) {\n          contestantsPost.push({\n            id: data.val().id,\n            post: data.val().post,\n            aspirants: Object.entries(data.val().aspirants ? data.val().aspirants : []).map(function (e) {\n              return Object.assign(e[1], {\n                aspirantKey: e[0]\n              });\n            })\n          });\n\n          _this.setState({\n            contestantsPost: contestantsPost\n          });\n\n          console.log(_this.state.contestantsPost);\n        });\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(AccordionExampleStandard, [{\n    key: \"showAlert\",\n    value: function showAlert(type, message) {\n      var _this2 = this;\n\n      this.setState({\n        alert: true,\n        alertData: {\n          type: type,\n          message: message\n        }\n      });\n      setTimeout(function () {\n        _this2.setState({\n          alert: false\n        });\n      }, 4000);\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.fetchAspirantsdata();\n      var voterId = localStorage.getItem('VOTERID');\n      this.setState({\n        voterId: voterId\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      var _this$state = this.state,\n          activeIndex = _this$state.activeIndex,\n          contestantsPost = _this$state.contestantsPost,\n          filteredPost = _this$state.filteredPost,\n          voterId = _this$state.voterId;\n      console.log(voterId);\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 113\n        },\n        __self: this\n      }, \"Welcome and Vote wisely!!\"), React.createElement(Container, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114\n        },\n        __self: this\n      }, React.createElement(Accordion, {\n        styled: true,\n        style: {\n          width: '100%'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115\n        },\n        __self: this\n      }, contestantsPost.map(function (item, index) {\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 118\n          },\n          __self: this\n        }, React.createElement(Accordion.Title, {\n          active: activeIndex === index,\n          index: index,\n          onClick: _this3.handleClick,\n          key: item.key,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 119\n          },\n          __self: this\n        }, React.createElement(Icon, {\n          name: \"dropdown\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 125\n          },\n          __self: this\n        }), item.post), React.createElement(Accordion.Content, {\n          active: activeIndex === index,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 128\n          },\n          __self: this\n        }, React.createElement(Card.Group, {\n          centered: true,\n          stretched: true,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 129\n          },\n          __self: this\n        }, item.aspirants.map(function (item, index) {\n          return React.createElement(Card, {\n            style: {\n              width: '200px',\n              height: '20%'\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 131\n            },\n            __self: this\n          }, React.createElement(Image, {\n            src: item.imageUrl ? item.imageUrl.downloadURL : '',\n            style: {\n              height: '120px'\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 132\n            },\n            __self: this\n          }), React.createElement(Card.Content, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 136\n            },\n            __self: this\n          }, React.createElement(Card.Header, {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 137\n            },\n            __self: this\n          }, React.createElement(\"center\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 138\n            },\n            __self: this\n          }, item.lastName + ' ' + item.firstName))), React.createElement(Card.Content, {\n            extra: true,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 143\n            },\n            __self: this\n          }, React.createElement(\"center\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 144\n            },\n            __self: this\n          }, !(item.votes && item.votes[voterId]) && React.createElement(Button, {\n            color: \"green\",\n            onClick: _this3.handleVote(item.prefectId, item.aspirantKey),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 145\n            },\n            __self: this\n          }, \"Vote \", item.votes ? Object.keys(item.votes).length : \"-\"), item.votes && item.votes[voterId] && React.createElement(Button, {\n            color: \"red\",\n            onClick: _this3.handleUnvote(item.prefectId, item.aspirantKey),\n            disabled: !(item.votes && item.votes[voterId]),\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 146\n            },\n            __self: this\n          }, \"Unvote \", item.votes ? Object.keys(item.votes).length : \"-\"))));\n        }))));\n      }))));\n    }\n  }]);\n\n  return AccordionExampleStandard;\n}(Component); // import React, {Component} from 'react';\n// import {Card, Icon, Image, Container, Button} from 'semantic-ui-react';\n// import per from './6.jpg';\n// import firebaseConf from './Firebase';\n// class Election extends Component {\n//   constructor() {\n//     super();\n//     this.state = {\n//       contestantsPost: [],\n//       totalNumberOfPositions: '',\n//       currentIndex: '',\n//     };\n//   }\n//   componentDidMount() {\n//     this.fetchAspirantsdata();\n//   }\n//   fetchAspirantsdata = () => {\n//     firebaseConf\n//       .database()\n//       .ref('posts')\n//       .orderByChild('prefect')\n//       .on('value', snapshot => {\n//         const contestantsPost = [];\n//         snapshot.forEach(data => {\n//           contestantsPost.push({\n//             id: data.val().id,\n//             post: data.val().post,\n//             aspirants: Object.values(\n//               data.val().aspirants ? data.val().aspirants : ''\n//             ),\n//           });\n//           this.setState({contestantsPost});\n//           console.log(this.state.contestantsPost);\n//         });\n//       });\n//   };\n//   render() {\n//     const {contestantsPost} = this.state;\n//     console.log(contestantsPost[1]);\n//     return (\n//       <div>\n//         <h1>Welcome and Vote wisely!!</h1>\n//         {/* {contestantsPost.aspirants &&\n//           contestantsPost.aspirants.map(constestant => {\n//             return ( */}\n//         {contestantsPost && (\n//           <div>\n//             {contestantsPost.map((item, index) => (\n//               <Container>\n//                 <center>\n//                   <h2>{item.post}</h2>\n//                 </center>\n//                 <br />\n//                 <Card.Group centered>\n//                   {item.aspirants.map(item => (\n//                     <Card style={{width: '25%', height: 'e'}}>\n//                       <Image src={per} />\n//                       <Card.Content>\n//                         <Card.Header>\n//                           <center>\n//                             {item.firstName + ' ' + item.lastName}\n//                           </center>\n//                         </Card.Header>\n//                       </Card.Content>\n//                       <Card.Content extra>\n//                         <center>\n//                           <Button color=\"green\">Vote</Button>\n//                         </center>\n//                       </Card.Content>\n//                     </Card>\n//                   ))}\n//                 </Card.Group>\n//               </Container>\n//             ))}\n//           </div>\n//         )}\n//         {/* );\n//           })} */}\n//       </div>\n//     );\n//   }\n// }\n// export default Election;\n\n\nexport { AccordionExampleStandard as default };","map":{"version":3,"sources":["C:\\Users\\raheem.azeezat\\Desktop\\e-voting\\src\\Components\\Election.js"],"names":["React","Component","Card","Icon","Image","Container","Button","Accordion","firebaseConf","per","AccordionExampleStandard","state","activeIndex","contestantsPost","filteredPost","handleClick","e","titleProps","index","newIndex","setState","filter","item","hasVoted","aspirants","map","votes","voterId","console","log","handleUnvote","prefectId","aspirantKey","removeRef","database","ref","remove","handleVote","itemsRef","child","set","then","catch","message","showAlert","isLoading","fetchAspirantsdata","orderByChild","on","snapshot","forEach","data","push","id","val","post","Object","entries","assign","type","alert","alertData","setTimeout","localStorage","getItem","width","key","height","imageUrl","downloadURL","lastName","firstName","keys","length"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\r\nimport {\r\n  Card,\r\n  Icon,\r\n  Image,\r\n  Container,\r\n  Button,\r\n  Accordion,\r\n} from 'semantic-ui-react';\r\nimport firebaseConf from './Firebase';\r\nimport per from './6.jpg';\r\n\r\nexport default class AccordionExampleStandard extends Component {\r\n  state = {activeIndex: '', contestantsPost: [], filteredPost: []};\r\n\r\n  showAlert(type, message) {\r\n        this.setState({\r\n          alert: true,\r\n          alertData: {type, message},\r\n        });\r\n        setTimeout(() => {\r\n          this.setState({alert: false});\r\n        }, 4000);\r\n      }\r\n\r\n  handleClick = async (e, titleProps) => {\r\n    const { contestantsPost } = this.state\r\n    \r\n    const {index} = titleProps;\r\n    const {activeIndex} = this.state;\r\n    const newIndex = activeIndex === index ? -1 : index;\r\n\r\n    this.setState({activeIndex: newIndex});\r\n\r\n    // Filter the current post that is opened\r\n    let filteredPost = await contestantsPost.filter((item, index) => {\r\n      return index === newIndex\r\n    })\r\n    await this.setState({ filteredPost })\r\n\r\n    let hasVoted = filteredPost.aspirants.map((item) => {\r\n      item.votes.map((item) => {\r\n        return item.voterId === this.state.voterId\r\n      })\r\n    })\r\n    console.log(this.state.filteredPost)\r\n    console.log(hasVoted)\r\n  };\r\n  componentDidMount() {\r\n    this.fetchAspirantsdata();\r\n    let voterId=localStorage.getItem('VOTERID');\r\n    this.setState({voterId})\r\n  }\r\n\r\n  handleUnvote=(prefectId,aspirantKey)=>()=>{\r\n    const{voterId}=this.state\r\n    \r\n    const removeRef = firebaseConf\r\n      .database()\r\n      .ref(`posts/${prefectId}/aspirants/${aspirantKey}/votes/${voterId}`);\r\n      removeRef.remove()\r\n    \r\n  }\r\n\r\n  handleVote=(prefectId,aspirantKey )=>()=>{\r\n    const{voterId}=this.state\r\n    const itemsRef = firebaseConf\r\n      .database()\r\n      .ref(`posts/${prefectId}/aspirants/${aspirantKey}/votes`);\r\n\r\n    itemsRef\r\n      .child(voterId).set({voterId: voterId})\r\n      .then(() => {\r\n      })\r\n      \r\n      .catch(message => {\r\n        console.log(`this is the error :${message}`);\r\n        this.showAlert('danger', message);\r\n      });\r\n    this.setState({isLoading: false});\r\n\r\n    \r\n  };\r\n\r\n  \r\n\r\n  fetchAspirantsdata = () => {\r\n    firebaseConf\r\n      .database()\r\n      .ref('posts')\r\n      .orderByChild('post')\r\n      .on('value', snapshot => {\r\n        const contestantsPost = [];\r\n        snapshot.forEach(data => {\r\n          contestantsPost.push({\r\n            id: data.val().id,\r\n            post: data.val().post,\r\n            aspirants: Object.entries(\r\n              data.val().aspirants ? data.val().aspirants : []\r\n            ).map(e => Object.assign(e[1], {aspirantKey: e[0]})),\r\n          });\r\n          this.setState({contestantsPost});\r\n          console.log(this.state.contestantsPost);\r\n        });\r\n      });\r\n  };\r\n\r\n  render() {\r\n    const {activeIndex, contestantsPost, filteredPost, voterId} = this.state;\r\nconsole.log(voterId)\r\n    return (\r\n      <div>\r\n        <h1>Welcome and Vote wisely!!</h1>\r\n        <Container>\r\n          <Accordion styled style={{width: '100%'}}>\r\n            {contestantsPost.map((item, index) => {\r\n              return (\r\n                <div>\r\n                  <Accordion.Title\r\n                    active={activeIndex === index}\r\n                    index={index}\r\n                    onClick={this.handleClick}\r\n                    key={item.key}\r\n                  >\r\n                    <Icon name=\"dropdown\" />\r\n                    {item.post}\r\n                  </Accordion.Title>\r\n                  <Accordion.Content active={activeIndex === index}>\r\n                    <Card.Group centered stretched>\r\n                      {item.aspirants.map((item, index) => (\r\n                        <Card style={{width: '200px', height: '20%'}}>\r\n                          <Image\r\n                            src={item.imageUrl ? item.imageUrl.downloadURL : ''}\r\n                            style={{height: '120px'}}\r\n                          />\r\n                          <Card.Content>\r\n                            <Card.Header>\r\n                              <center>\r\n                                {item.lastName + ' ' + item.firstName}\r\n                              </center>\r\n                            </Card.Header>\r\n                          </Card.Content>\r\n                          <Card.Content extra>\r\n                            <center>\r\n                            {!(item.votes && item.votes[voterId])  && <Button color=\"green\" onClick={this.handleVote(item.prefectId, item.aspirantKey)} >Vote {item.votes?Object.keys(item.votes).length:\"-\"}</Button>}\r\n                              { (item.votes && item.votes[voterId] ) && <Button color=\"red\" onClick={this.handleUnvote(item.prefectId, item.aspirantKey)} disabled={!(item.votes && item.votes[voterId])}>Unvote {item.votes?Object.keys(item.votes).length:\"-\"}</Button>}\r\n                            </center>\r\n                          </Card.Content>\r\n                        </Card>\r\n                      ))}\r\n                    </Card.Group>\r\n                  </Accordion.Content>\r\n                </div>\r\n              );\r\n            })}\r\n          </Accordion>\r\n        </Container>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\n// import React, {Component} from 'react';\r\n// import {Card, Icon, Image, Container, Button} from 'semantic-ui-react';\r\n// import per from './6.jpg';\r\n// import firebaseConf from './Firebase';\r\n// class Election extends Component {\r\n//   constructor() {\r\n//     super();\r\n//     this.state = {\r\n//       contestantsPost: [],\r\n//       totalNumberOfPositions: '',\r\n//       currentIndex: '',\r\n//     };\r\n//   }\r\n//   componentDidMount() {\r\n//     this.fetchAspirantsdata();\r\n//   }\r\n\r\n//   fetchAspirantsdata = () => {\r\n//     firebaseConf\r\n//       .database()\r\n//       .ref('posts')\r\n//       .orderByChild('prefect')\r\n//       .on('value', snapshot => {\r\n//         const contestantsPost = [];\r\n//         snapshot.forEach(data => {\r\n//           contestantsPost.push({\r\n//             id: data.val().id,\r\n//             post: data.val().post,\r\n//             aspirants: Object.values(\r\n//               data.val().aspirants ? data.val().aspirants : ''\r\n//             ),\r\n//           });\r\n//           this.setState({contestantsPost});\r\n//           console.log(this.state.contestantsPost);\r\n//         });\r\n//       });\r\n//   };\r\n//   render() {\r\n//     const {contestantsPost} = this.state;\r\n//     console.log(contestantsPost[1]);\r\n\r\n//     return (\r\n//       <div>\r\n//         <h1>Welcome and Vote wisely!!</h1>\r\n//         {/* {contestantsPost.aspirants &&\r\n//           contestantsPost.aspirants.map(constestant => {\r\n//             return ( */}\r\n//         {contestantsPost && (\r\n//           <div>\r\n//             {contestantsPost.map((item, index) => (\r\n//               <Container>\r\n//                 <center>\r\n//                   <h2>{item.post}</h2>\r\n//                 </center>\r\n//                 <br />\r\n//                 <Card.Group centered>\r\n//                   {item.aspirants.map(item => (\r\n//                     <Card style={{width: '25%', height: 'e'}}>\r\n//                       <Image src={per} />\r\n//                       <Card.Content>\r\n//                         <Card.Header>\r\n//                           <center>\r\n//                             {item.firstName + ' ' + item.lastName}\r\n//                           </center>\r\n//                         </Card.Header>\r\n//                       </Card.Content>\r\n//                       <Card.Content extra>\r\n//                         <center>\r\n//                           <Button color=\"green\">Vote</Button>\r\n//                         </center>\r\n//                       </Card.Content>\r\n//                     </Card>\r\n//                   ))}\r\n//                 </Card.Group>\r\n//               </Container>\r\n//             ))}\r\n//           </div>\r\n//         )}\r\n\r\n//         {/* );\r\n//           })} */}\r\n//       </div>\r\n//     );\r\n//   }\r\n// }\r\n\r\n// export default Election;\r\n"]},"metadata":{},"sourceType":"module"}